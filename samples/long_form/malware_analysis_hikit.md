# Malware Report: Sample

| Key                      | Value        |
|:-------------------------|:-------------|
| Reverse Engineer         | [Novetta Malware Analysis Team](http://www.novetta.com/wp-content/uploads/2014/11/HiKit.pdf) |
| Date                     | 2014/11/01? |
| Requester                | Intelligence Team |
| Associated Intrusion Set | GLASS WIZARD |

## Summary

> This may be the only piece consumers read so cover the key findings  

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

## Basic Static Analysis:

- File Name: oci.dll 
- File Type: Portable Executable - Win32 Dynamic-Link Library 
- File Size: 262656 bytes

### Hashes:

> Static file hashes useful for pivoting

| Hash Algorithm | Value                                                                  |
|:---------------|:-----------------------------------------------------------------------|
| MD5            | d3fb2b78fd7815878a70eac35f2945df |
| SHA1           | 8d6292bd0abaaf3cf8c162d8c6bf7ec16a5ffba7 |
| SHA256         | aa4b2b448a5e246888304be51ef9a65a11a53bab7899bc1b56e4fc20e1b1fd9f |
| SHA512         |  |
| Ssdeep         | 6144:xH8/y2gN1qJ2uvknuXsK+yW14LSb5kFiE:6/y9N1ruvkiEyW14LSb5kB |

### Current anti-virus detection capabilities:

> Gathered from VirusTotal these are useful for understanding organization wide detection (Table truncated for space)

| Vendor   | Sample        |
|:---------|:--------------|
| Avast | Win32:Hikit-B [Rtk] | 
| ClamAV| Win.Trojan.HiKit-16 |
| CrowdStrike | - |
| ESET-NOD32 | Win32/Hikit.A |
| F-Secure | Gen:Variant.Graftor.40878 |
| Kaspersky | Trojan.Win32.Hiki.a |
| Malwarebytes | - |
| McAfee | GenericR-DFC!D3FB2B78FD78
| Microsoft | Backdoor:Win32/Hikiti.M!dha
| Qihoo-360 |  Trojan.Generic |
| Sophos | Troj/PWS-BZI | 
| Symantec | Backdoor.Hikit |
| TrendMicro | BKDR_HIKIT.A |

### Interesting Strings

> Unique static file strings helpful for building detection such as Yara signatures

- `Nihonbashi Kodenmachou10-61`
- `7fw.ndi`
- `W7fwMP`
- `CatalogFile= w7fw.cat`
- `ClassGUID  = {4D36E974-E325-11CE-BFC1-08002BE10318}`
- `ClassGUID  = {4d36e972-e325-11ce-bfc1-08002be10318}`
- `CopyFiles       = W7fw.Files.Sys`
- `DelFiles = W7fw.Files.Sys`
- `DiskDescription = "Microsoft W7fw Driver Disk"`
- `W7fwmp`
- `W7fw_HELP`
- `Norwegian-Nynorsk`
- `W7fw.Files.Sys = 12`
- `W7fw.sys`
- `W7fwMP_Desc = "W7fw Miniport"`
- `W7fwService_Desc = "W7fw Service"`
- `W7fw_Desc = "W7fw Driver"`
- `h:\JmVodServer\hikit\bin32\RServer.pdb`
- `h:\JmVodServer\hikit\bin32\w7fw.pdb`
- `h:\JmVodServer\hikit\bin32\w7fw_2k.pdb`
- `h:\JmVodServer\hikit\bin64\w7fw_x64.pdb`

### Other Relevant Files or Data:

- `RServer.pdb`
- `w7fw.pdb`
- `w7fw_2k.pdb`
- `w7fw_x64.pdb`
- `W7fw.sys`
- Driver file, currently unknown to us.

## Basic Dynamic Analysis

> Input from an automated sandbox

N/A. Using information from 3rd party report.

## Behavioral Characteristics

> Descriptions of how the malware accomplishes it's major goals, based on kill chain methods

- Acts as a remote access trojan including:
	- shell: Allows remote shell access to the victim system
	- file: Gives direct filesystem access
	- connect: Establishes a port forwarded connection
	- socks5: Forwards proxy traffic
	- exit: ends channel
- Recieves HTTP request from outside host (malware acts as service) by intercepting network traffic.

### Delivery Mechanisms:

> How the malware got to the victim system

- Second stage tool, delivered via adversary upload to target host.

### Persistence Mechanisms:

> How the malware runs at startup and continues running

- Runs as a service on the compromised host.
- Sets registry keys to maintain persistence. 

### Spreading Mechanisms:

> How the malware migrates between systems

- Manual. Attacker may proxy through an infected host in spreading. 

### Exfiltration Mechanisms:

> How the malware uses to move data outside the victim network

- File exfiltration may take place via `file` command. 

### Command and Control Mechanisms:

> How the malware is given tasking by the attacker

- Attacker access the victim host via direct network connection (IE host must be internet facing). 
- Attacker uses the `/password` path.

## Dependencies

> System level requirements for the malware to execute

### Supported Operating Systems:
- Microsoft Windows operating system (versions unknown)

### Required Files:
- Driver file that allows

### Second Stage Downloads:
- N/A (this is a second stage kit) 

### Registry Keys:
- Unknown 

## Detection

> Unenriched information from the sample useful for identifying infections.

### Network Indicators of Compromise

> Network strings, domains, URLs, tls certificates, IPv4, IPv6 Addresses, etc.

- N/A at this time (as this is a server component) 

### File System Indicators of Compromise

> File strings, file paths, signing certificates, registery keys, mutexts, etc.

- "YNK Japan Inc." code signing certificate.
- See strings & hashes above.

## Response Recommendations

> Incident response centric steps for pausing and removing the malware.

### Mitigation Steps:
- Disrupt internet facing network access for an infected system.
- Secondary: Block internal network access to avoid the attacker using an interna proxy.

### Eradication Steps:
- Because tool is installed by adversary manually a full rebuild of infected system is recommended.

## Related Files

> Important for establishing relationships between exploits, droppers, RATs, etc

- Unknown at this time. 
